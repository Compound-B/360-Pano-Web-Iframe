TWP.Module=TWP.Module||{};(function(a){TWP.Module.DocCloud=function(i){var f=i,h=true,d=a("#"+f.container);var g=function(){ich.grabTemplates();if(f.gdoc_id){c()}},c=function(){SimpleTable.init({key:f.gdoc_id,cached:true,callback:e})},e=function(k){var j=d.find(".element-container");a.each(k,function(m,n){var l=ich.element(n);j.append(l)});b()},b=function(){var l=f.container+"-document";d.find(".DV-container").attr("id",l);var j="http://www.documentcloud.org/documents/"+f.doccloud_id+".js";var k=d.find("#"+l).width();DV.load(j,{width:k,height:750,sidebar:false,container:"#"+l});d.find(".DV-container").on("click",".DV-annotation",function(r){var s=a(this).data("id");var p=a(this).closest(".DV-set");var o=p.attr("class");if(o){var n=o.split(" ");var q="";a.each(o,function(t,u){if(u.indexOf("DV-page-")!==-1){q=u.replace("DV-page-","");return false}});var m="#document/p"+q+"/a"+s;d.find('.element[href="'+m+'"]').trigger("click")}}).on("click",".DV-trigger",function(m){m.stopPropagation();if(a(this).hasClass("DV-annotationNext")){d.find(".DV-activeAnnotation").next(".DV-annotation").trigger("click")}else{d.find(".DV-activeAnnotation").next(".DV-annotation").trigger("click")}});d.find(".element").on("click",function(){a(this).addClass("active").siblings(".active").removeClass("active")});if(window.location.hash!==""){d.find('.element[href="'+window.location.hash+'"]').trigger("click")}};g()}})(jQuery);